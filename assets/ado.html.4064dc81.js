import{_ as n}from"./plugin-vue_export-helper.21dcd24c.js";import{d as s}from"./app.8dd3a59a.js";const a={},p=s(`<h1 id="ado" tabindex="-1"><a class="header-anchor" href="#ado" aria-hidden="true">#</a> ADO</h1><p>Ado \u662F IFreeSql \u4E0B\u91CD\u8981\u7684\u5BF9\u8C61\u4E4B\u4E00\uFF0C\u5B83\u5305\u62EC\u6240\u6709\u5BF9 SQL \u64CD\u4F5C\u7684\u5C01\u88C5\uFF0C\u63D0\u4F9B ExecuteReader\u3001ExecuteDataSet\u3001ExecuteDataTable\u3001ExecuteNonQuery\u3001ExecuteScalar \u7B49\u65B9\u6CD5\uFF0C\u4F7F\u7528\u8D77\u6765\u548C\u4F20\u7EDF SqlHelper \u4E00\u6837\u3002</p><h2 id="\u67E5\u8BE2-sql-\u8FD4\u56DE\u5B9E\u4F53" tabindex="-1"><a class="header-anchor" href="#\u67E5\u8BE2-sql-\u8FD4\u56DE\u5B9E\u4F53" aria-hidden="true">#</a> \u67E5\u8BE2 SQL \u8FD4\u56DE\u5B9E\u4F53</h2><div class="language-csharp ext-cs line-numbers-mode"><pre class="language-csharp"><code><span class="token comment">//\u8FD4\u56DE\u591A\u6761\u8BB0\u5F55</span>
<span class="token class-name">List<span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> fsql<span class="token punctuation">.</span>Ado<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Query</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">&quot;select * from t1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//\u8FD4\u56DE\u5355\u6761\u8BB0\u5F55</span>
<span class="token class-name">T</span> item <span class="token operator">=</span> fsql<span class="token punctuation">.</span>Ado<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">QuerySingle</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">&quot;select * from t1 where id = @id&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token punctuation">{</span> id <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//\u8FD4\u56DE\u591A\u4E2A\u7ED3\u679C\u96C6</span>
<span class="token class-name"><span class="token keyword">var</span></span> result <span class="token operator">=</span> fsql<span class="token punctuation">.</span>Ado<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Query</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>T1<span class="token punctuation">,</span> T2<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">&quot;select * from t1; select * from t2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">List<span class="token punctuation">&lt;</span>T1<span class="token punctuation">&gt;</span></span> list1 <span class="token operator">=</span> result<span class="token punctuation">.</span>Item1<span class="token punctuation">;</span>
<span class="token class-name">List<span class="token punctuation">&lt;</span>T2<span class="token punctuation">&gt;</span></span> list2 <span class="token operator">=</span> result<span class="token punctuation">.</span>Item2<span class="token punctuation">;</span>

<span class="token comment">// like \u67E5\u8BE2</span>
<span class="token class-name"><span class="token keyword">string</span></span> searchText <span class="token operator">=</span> <span class="token string">&quot;abc&quot;</span><span class="token punctuation">;</span>
<span class="token class-name">List<span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span> users <span class="token operator">=</span> _fsql<span class="token punctuation">.</span>Ado<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Query</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">&quot;select * from t1 where name like @name&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token punctuation">{</span> name <span class="token operator">=</span> <span class="token string">&quot;%&quot;</span> <span class="token operator">+</span> searchText <span class="token operator">+</span> <span class="token string">&quot;%&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h2 id="\u53C2\u6570\u5316" tabindex="-1"><a class="header-anchor" href="#\u53C2\u6570\u5316" aria-hidden="true">#</a> \u53C2\u6570\u5316</h2><p>Ado \u4E0B\u9762\u6240\u6709\u53C2\u6570 object parms \u90FD\u53EF\u4EE5\u63A5\u53D7\u533F\u540D\u5BF9\u8C61\uFF0C\u6216\u8005\u5B57\u5178\uFF1A</p><ul><li>new { id = 1, name = &quot;xx&quot; }</li><li>new Dictionary&lt;string, object&gt; { [&quot;id&quot;] = 1, [&quot;name&quot;] = &quot;xx&quot; }</li></ul><p>\u5173\u4E8E\u53C2\u6570\u524D\u7F00\uFF1A</p><ul><li>odbc \u662F ? \u5E76\u4E14\u6CA1\u6709\u6807\u8BC6\uFF0C\u6240\u4EE5 freesql \u7981\u7528\u4E86 odbc \u53C2\u6570\u5316</li><li>oracle \u662F :</li><li>mysql.data \u662F ?</li><li>mysqlconnector \u662F @</li><li>\u5176\u4ED6\u57FA\u672C\u90FD\u662F @</li></ul><p>IN \u53C2\u6570\u5316\u67E5\u8BE2\uFF1A</p><blockquote><p>\u5F53\u524D\u4EC5\u652F\u6301 Array \u548C IList \u7C7B\u578B\u7ED1\u5B9A</p></blockquote><div class="language-csharp ext-cs line-numbers-mode"><pre class="language-csharp"><code><span class="token class-name"><span class="token keyword">var</span></span> ids <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> <span class="token punctuation">{</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token class-name">List<span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> fsql<span class="token punctuation">.</span>Ado<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Query</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token string">&quot;select * from t1 where id in @ids&quot;</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token punctuation">{</span> ids <span class="token operator">=</span> ids <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="\u68C0\u6D4B\u8FDE\u63A5" tabindex="-1"><a class="header-anchor" href="#\u68C0\u6D4B\u8FDE\u63A5" aria-hidden="true">#</a> \u68C0\u6D4B\u8FDE\u63A5</h2><div class="language-csharp ext-cs line-numbers-mode"><pre class="language-csharp"><code><span class="token class-name"><span class="token keyword">bool</span></span> isok <span class="token operator">=</span> fsql<span class="token punctuation">.</span>Ado<span class="token punctuation">.</span><span class="token function">ExecuteConnectTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="commandfluent" tabindex="-1"><a class="header-anchor" href="#commandfluent" aria-hidden="true">#</a> CommandFluent</h2><p>fsql.Ado \u91CD\u8F7D\u65B9\u6CD5\u592A\u591A\u7684\u60C5\u51B5\u4E0B\uFF0C\u5EFA\u8BAE\u4F7F\u7528 CommandFluent\uFF0C\u4F8B\u5982\u5B58\u50A8\u8FC7\u7A0B\uFF1A</p><div class="language-csharp ext-cs line-numbers-mode"><pre class="language-csharp"><code><span class="token class-name">DbParameter</span> p2 <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
fsql<span class="token punctuation">.</span>Ado<span class="token punctuation">.</span><span class="token function">CommandFluent</span><span class="token punctuation">(</span><span class="token string">&quot;dbo.GetICMaxNum&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">CommandType</span><span class="token punctuation">(</span>CommandType<span class="token punctuation">.</span>StoredProcedure<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">CommandTimeout</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span>

    <span class="token punctuation">.</span><span class="token function">WithParameter</span><span class="token punctuation">(</span><span class="token string">&quot;TableName&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;tb1&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">WithParameter</span><span class="token punctuation">(</span><span class="token string">&quot;FInterID&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> p <span class="token operator">=&gt;</span>
    <span class="token punctuation">{</span>
        <span class="token comment">//(p as OracleParameter).OracleType = ...;</span>
        p2 <span class="token operator">=</span> p<span class="token punctuation">;</span> <span class="token comment">//Output \u53C2\u6570</span>
        p<span class="token punctuation">.</span>DbType <span class="token operator">=</span> DbType<span class="token punctuation">.</span>Int32<span class="token punctuation">;</span>
        p<span class="token punctuation">.</span>Direction <span class="token operator">=</span> ParameterDirection<span class="token punctuation">.</span>Output<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">ExecuteNonQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//.Query&lt;T&gt;() \u6216\u8005 .ExecuteDataTable() \u6216\u8005 ...</span>

Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>p2<span class="token punctuation">.</span>Value<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>Oracle \u5B58\u50A8\u8FC7\u7A0B\u83B7\u53D6 DataTable\uFF1A</p><div class="language-csharp ext-cs line-numbers-mode"><pre class="language-csharp"><code><span class="token class-name">OracleParameter</span> p2 <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">var</span></span> dt <span class="token operator">=</span> fsql<span class="token punctuation">.</span>Ado<span class="token punctuation">.</span><span class="token function">CommandFluent</span><span class="token punctuation">(</span><span class="token string">&quot;getTableInfo&quot;</span><span class="token punctuation">)</span>
     <span class="token punctuation">.</span><span class="token function">CommandType</span><span class="token punctuation">(</span>CommandType<span class="token punctuation">.</span>StoredProcedure<span class="token punctuation">)</span>
     <span class="token punctuation">.</span><span class="token function">CommandTimeout</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span>
     <span class="token punctuation">.</span><span class="token function">WithParameter</span><span class="token punctuation">(</span><span class="token string">&quot;out_var&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> p <span class="token operator">=&gt;</span>
     <span class="token punctuation">{</span>
         p2 <span class="token operator">=</span> p <span class="token keyword">as</span> <span class="token class-name">OracleParameter</span><span class="token punctuation">;</span>

         p2<span class="token punctuation">.</span>OracleDbType <span class="token operator">=</span> OracleDbType<span class="token punctuation">.</span>RefCursor<span class="token punctuation">;</span>
         p2<span class="token punctuation">.</span>Direction <span class="token operator">=</span> ParameterDirection<span class="token punctuation">.</span>Output<span class="token punctuation">;</span>

     <span class="token punctuation">}</span><span class="token punctuation">)</span>
     <span class="token punctuation">.</span><span class="token function">ExecuteDataTable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>dt<span class="token punctuation">.</span>Rows<span class="token punctuation">.</span>Count<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h2 id="ado-net-\u6269\u5C55\u65B9\u6CD5" tabindex="-1"><a class="header-anchor" href="#ado-net-\u6269\u5C55\u65B9\u6CD5" aria-hidden="true">#</a> Ado.net \u6269\u5C55\u65B9\u6CD5</h2><p>\u63D0\u4F9B\u4E86\u7C7B\u4F3C Dapper \u7684\u4F7F\u7528\u65B9\u6CD5\uFF0CFreeSql \u589E\u52A0\u4E86 IDbConnection/IDbTransaction \u5BF9\u8C61\u7684\u6269\u5C55\u65B9\u6CD5 Select/Insert/Update/Delete \u5B9E\u73B0 CRUD\u3002</p><div class="language-csharp ext-cs line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">using</span> <span class="token namespace">FreeSql</span><span class="token punctuation">;</span>

<span class="token keyword">using</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token keyword">var</span></span> conn <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SqlConnection</span><span class="token punctuation">(</span><span class="token range operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
  <span class="token comment">//IFreeSql fsql = conn.GetIFreeSql();</span>
  <span class="token comment">//fsql.CodeFirst.IsNoneCommandParameter = true;</span>
  <span class="token comment">//fsql.CodeFirst.IsSyncStructureToUpper = true;</span>
  <span class="token comment">//fsql.Aop.CommandBefore += (_, e) =&gt; Trace.WriteLine(e.Command.CommandText);</span>
  <span class="token comment">//\u4EE5\u4E0A\u6574\u4E2A\u7A0B\u5E8F\u53EA\u9700\u8981\u8BBE\u7F6E\u4E00\u6B21</span>

  conn<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Select</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token range operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ToList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  conn<span class="token punctuation">.</span><span class="token function">Insert</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">T</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ExecuteAffrows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  conn<span class="token punctuation">.</span><span class="token function">Update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetSource</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">T</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ExecuteAffrows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  conn<span class="token punctuation">.</span><span class="token function">InsertOrUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetSource</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">T</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ExecuteAffrows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  conn<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Delete</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token range operator">..</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ExecuteAffrows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><ul><li>\u6BCF\u4E2A SqlConnection GetFreeSql() \u8FD4\u56DE\u7684 IFreeSql \u5B9E\u4F8B\u76F8\u540C\uFF1B</li><li>\u53EF\u4EE5\u5BF9 fsql \u8BBE\u7F6E Aop \u4E8B\u4EF6\uFF0C\u6BD4\u5982\u76D1\u89C6 SQL\uFF1B</li><li>IFreeSql \u81EA\u8EAB\u7684\u6210\u5458 IDbFirst\u3001Transaction \u4E0D\u53EF\u7528\uFF1B</li></ul><p>\u5229\u7528\u672C\u529F\u80FD\u53EF\u4EE5\u5FEB\u901F\u5C06 FreeSql \u4F7F\u7528\u5230\u9879\u76EE\u4E2D\uFF0C\u53EA\u9700\u8981\u5904\u7406\u597D\u5B9E\u4F53\u7C7B\u7684\u7279\u6027\u3002</p><p>\u63D0\u793A\uFF1AFreeSql \u517C\u5BB9 EFCore 99% \u7684\u5B9E\u4F53\u7279\u6027</p>`,25);function t(e,o){return p}var u=n(a,[["render",t],["__file","ado.html.vue"]]);export{u as default};
