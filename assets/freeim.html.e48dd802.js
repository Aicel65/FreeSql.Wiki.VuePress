import{_ as e}from"./plugin-vue_export-helper.21dcd24c.js";import{r as p,o,c,a as n,b as t,e as s,d as i}from"./app.2c96bab7.js";const l={},r=n("h1",{id:"freeim",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#freeim","aria-hidden":"true"},"#"),s(" FreeIM")],-1),d=n("p",null,"FreeIM \u4F7F\u7528 websocket \u534F\u8BAE\u5B9E\u73B0\u7B80\u6613\u3001\u9AD8\u6027\u80FD\uFF08\u5355\u673A\u652F\u63015\u4E07+\u8FDE\u63A5\uFF09\u3001\u96C6\u7FA4\u5373\u65F6\u901A\u8BAF\u7EC4\u4EF6\uFF0C\u652F\u6301\u70B9\u5BF9\u70B9\u901A\u8BAF\u3001\u7FA4\u804A\u901A\u8BAF\u3001\u4E0A\u7EBF\u4E0B\u7EBF\u4E8B\u4EF6\u6D88\u606F\u7B49\u4F17\u591A\u5B9E\u7528\u6027\u529F\u80FD\u3002",-1),u=n("p",null,"\u4F7F\u7528\u573A\u666F\uFF1A\u597D\u53CB\u804A\u5929\u3001\u7FA4\u804A\u5929\u3001\u76F4\u64AD\u95F4\u3001\u5B9E\u65F6\u8BC4\u8BBA\u533A\u3001\u6E38\u620F\u3002",-1),k=s("\u5F00\u6E90\u5730\u5740\uFF1A"),v={href:"https://github.com/2881099/FreeIM",target:"_blank",rel:"noopener noreferrer"},m=s("https://github.com/2881099/FreeIM"),h=s("\u6269\u5C55\u8D44\u6599\uFF1A"),b={href:"https://www.cnblogs.com/FreeSql/p/16632727.html",target:"_blank",rel:"noopener noreferrer"},_=s("\u300AC#.NET im \u804A\u5929\u901A\u8BAF\u67B6\u6784\u8BBE\u8BA1 -- FreeIM \u652F\u6301\u96C6\u7FA4\u3001\u804C\u8D23\u5206\u660E\u3001\u9AD8\u6027\u80FD\u300B"),f=i(`<blockquote><p>dotnet add package FreeIM</p></blockquote><h2 id="imserver-\u670D\u52A1\u7AEF" tabindex="-1"><a class="header-anchor" href="#imserver-\u670D\u52A1\u7AEF" aria-hidden="true">#</a> ImServer \u670D\u52A1\u7AEF</h2><div class="language-csharp ext-cs line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Configure</span><span class="token punctuation">(</span><span class="token class-name">IApplicationBuilder</span> app<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    app<span class="token punctuation">.</span><span class="token function">UseFreeImServer</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">ImServerOptions</span>
    <span class="token punctuation">{</span>
        Redis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">FreeRedis<span class="token punctuation">.</span>RedisClient</span><span class="token punctuation">(</span><span class="token string">&quot;127.0.0.1:6379,poolsize=5&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        Servers <span class="token operator">=</span> <span class="token keyword">new</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token string">&quot;127.0.0.1:6001&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token comment">//\u96C6\u7FA4\u914D\u7F6E</span>
        Server <span class="token operator">=</span> <span class="token string">&quot;127.0.0.1:6001&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>\u4E00\u5957\u6C38\u8FDC\u4E0D\u9700\u8981\u8FED\u4EE3\u66F4\u65B0\u7684 <code>ImServer</code> \u670D\u52A1\u7AEF\uFF0C\u652F\u6301 .NET6.0\u3001.NETCore2.1+\u3001NETStandard2.0</p></blockquote><h2 id="webapi-\u4E1A\u52A1\u7AEF" tabindex="-1"><a class="header-anchor" href="#webapi-\u4E1A\u52A1\u7AEF" aria-hidden="true">#</a> WebApi \u4E1A\u52A1\u7AEF</h2><div class="language-csharp ext-cs line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Configure</span><span class="token punctuation">(</span><span class="token class-name">IApplicationBuilder</span> app<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">//...</span>

    ImHelper<span class="token punctuation">.</span><span class="token function">Initialization</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">ImClientOptions</span>
    <span class="token punctuation">{</span>
        Redis <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">FreeRedis<span class="token punctuation">.</span>RedisClient</span><span class="token punctuation">(</span><span class="token string">&quot;127.0.0.1:6379,poolsize=5&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        Servers <span class="token operator">=</span> <span class="token keyword">new</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token string">&quot;127.0.0.1:6001&quot;</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    ImHelper<span class="token punctuation">.</span><span class="token function">EventBus</span><span class="token punctuation">(</span>
        t <span class="token operator">=&gt;</span> Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>clientId <span class="token operator">+</span> <span class="token string">&quot;\u4E0A\u7EBF\u4E86&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
        t <span class="token operator">=&gt;</span> Console<span class="token punctuation">.</span><span class="token function">WriteLine</span><span class="token punctuation">(</span>t<span class="token punctuation">.</span>clientId <span class="token operator">+</span> <span class="token string">&quot;\u4E0B\u7EBF\u4E86&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><table><thead><tr><th>ImHelper\u65B9\u6CD5</th><th>\u53C2\u6570</th><th>\u63CF\u8FF0</th></tr></thead><tbody><tr><td>PrevConnectServer</td><td>(clientId, string)</td><td>\u5728\u7EC8\u7AEF\u51C6\u5907\u8FDE\u63A5 websocket \u524D\u8C03\u7528</td></tr><tr><td>SendMessage</td><td>(\u53D1\u9001\u8005, \u63A5\u6536\u8005, \u6D88\u606F\u5185\u5BB9, \u662F\u5426\u56DE\u6267)</td><td>\u53D1\u9001\u6D88\u606F</td></tr><tr><td>GetClientListByOnline</td><td>-</td><td>\u8FD4\u56DE\u6240\u6709\u5728\u7EBFclientId</td></tr><tr><td>HasOnline</td><td>clientId</td><td>\u5224\u65AD\u5BA2\u6237\u7AEF\u662F\u5426\u5728\u7EBF</td></tr><tr><td>EventBus</td><td>(\u4E0A\u7EBF\u59D4\u6258, \u79BB\u7EBF\u59D4\u6258)</td><td>socket\u4E0A\u7EBF\u4E0E\u4E0B\u7EBF\u4E8B\u4EF6</td></tr></tbody></table><table><thead><tr><th>\u9891\u9053</th><th>\u53C2\u6570</th><th>\u63CF\u8FF0</th></tr></thead><tbody><tr><td>JoinChan</td><td>(clientId, \u9891\u9053\u540D)</td><td>\u52A0\u5165</td></tr><tr><td>LeaveChan</td><td>(clientId, \u9891\u9053\u540D)</td><td>\u79BB\u5F00</td></tr><tr><td>GetChanClientList</td><td>(\u9891\u9053\u540D)</td><td>\u83B7\u53D6\u9891\u9053\u6240\u6709clientId</td></tr><tr><td>GetChanList</td><td>-</td><td>\u83B7\u53D6\u6240\u6709\u9891\u9053\u548C\u5728\u7EBF\u4EBA\u6570</td></tr><tr><td>GetChanListByClientId</td><td>(clientId)</td><td>\u83B7\u53D6\u7528\u6237\u53C2\u4E0E\u7684\u6240\u6709\u9891\u9053</td></tr><tr><td>GetChanOnline</td><td>(\u9891\u9053\u540D)</td><td>\u83B7\u53D6\u9891\u9053\u7684\u5728\u7EBF\u4EBA\u6570</td></tr><tr><td>SendChanMessage</td><td>(clientId, \u9891\u9053\u540D, \u6D88\u606F\u5185\u5BB9)</td><td>\u53D1\u9001\u6D88\u606F\uFF0C\u6240\u6709\u5728\u7EBF\u7684\u7528\u6237\u5C06\u6536\u5230\u6D88\u606F</td></tr></tbody></table><ul><li>clientId \u5E94\u8BE5\u4E0E\u7528\u6237id\u76F8\u540C\uFF0C\u6216\u8005\u5173\u8054\uFF1B</li><li>\u9891\u9053\u9002\u7528\u4E34\u65F6\u7684\u7FA4\u804A\u9700\u6C42\uFF0C\u5982\u804A\u5929\u5BA4\u3001\u8BA8\u8BBA\u533A\uFF1B</li></ul><blockquote><p>ImHelper \u652F\u6301 .NetFramework 4.5+\u3001.NetStandard 2.0</p></blockquote><h2 id="html5-\u7EC8\u7AEF" tabindex="-1"><a class="header-anchor" href="#html5-\u7EC8\u7AEF" aria-hidden="true">#</a> Html5 \u7EC8\u7AEF</h2><p>\u7EC8\u7AEF\u8FDE\u63A5 websocket \u524D\uFF0C\u5E94\u8BE5\u5148\u8BF7\u6C42 <code>WebApi</code> \u83B7\u5F97\u6388\u6743\u8FC7\u7684\u5730\u5740(ImHelper.PrevConnectServer)\uFF0C\u4F2A\u4EE3\u7801\uFF1A</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token string">&#39;/prev-connect-imserver&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> url <span class="token operator">=</span> data<span class="token punctuation">;</span> <span class="token comment">//\u6B64\u65F6\u7684\u503C\uFF1Aws://127.0.0.1:6001/ws?token=xxxxx</span>
    <span class="token keyword">var</span> sock <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebSocket</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
    sock<span class="token punctuation">.</span><span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//...</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,13);function g(w,I){const a=p("ExternalLinkIcon");return o(),c("div",null,[r,d,u,n("p",null,[k,n("a",v,[m,t(a)])]),n("p",null,[h,n("a",b,[_,t(a)])]),f])}var q=e(l,[["render",g],["__file","freeim.html.vue"]]);export{q as default};
