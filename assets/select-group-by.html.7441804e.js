import{_ as n}from"./plugin-vue_export-helper.21dcd24c.js";import{d as s}from"./app.15a13f85.js";const a={},t=s(`<h1 id="\u5206\u7EC4\u805A\u5408" tabindex="-1"><a class="header-anchor" href="#\u5206\u7EC4\u805A\u5408" aria-hidden="true">#</a> \u5206\u7EC4\u805A\u5408</h1><div class="language-csharp ext-cs line-numbers-mode"><pre class="language-csharp"><code><span class="token keyword">static</span> <span class="token class-name">IFreeSql</span> fsql <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">FreeSql<span class="token punctuation">.</span>FreeSqlBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">UseConnectionString</span><span class="token punctuation">(</span>FreeSql<span class="token punctuation">.</span>DataType<span class="token punctuation">.</span>MySql<span class="token punctuation">,</span> <span class="token string">&quot;Data Source=127.0.0.1;Port=3306;User ID=root;Password=root;Initial Catalog=cccddd;Charset=utf8;SslMode=none;Max pool size=10&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">Build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//\u8BF7\u52A1\u5FC5\u5B9A\u4E49\u6210 Singleton \u5355\u4F8B\u6A21\u5F0F</span>

<span class="token keyword">class</span> <span class="token class-name">Topic</span> <span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">Column</span><span class="token attribute-arguments"><span class="token punctuation">(</span>IsIdentity <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span> IsPrimary <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> Id <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">int</span></span> Clicks <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> Title <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token return-type class-name">DateTime</span> CreateTime <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="groupby\u5206\u7EC4\u805A\u5408" tabindex="-1"><a class="header-anchor" href="#groupby\u5206\u7EC4\u805A\u5408" aria-hidden="true">#</a> GroupBy\u5206\u7EC4\u805A\u5408</h2><div class="language-csharp ext-cs line-numbers-mode"><pre class="language-csharp"><code><span class="token class-name"><span class="token keyword">var</span></span> list <span class="token operator">=</span> fsql<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Select</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Topic<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">GroupBy</span><span class="token punctuation">(</span>a <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token punctuation">{</span> tt2 <span class="token operator">=</span> a<span class="token punctuation">.</span>Title<span class="token punctuation">.</span><span class="token function">Substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> mod4 <span class="token operator">=</span> a<span class="token punctuation">.</span>Id <span class="token operator">%</span> <span class="token number">4</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">Having</span><span class="token punctuation">(</span>a <span class="token operator">=&gt;</span> a<span class="token punctuation">.</span><span class="token function">Count</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> a<span class="token punctuation">.</span><span class="token function">Avg</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>Key<span class="token punctuation">.</span>mod4<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> a<span class="token punctuation">.</span><span class="token function">Max</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>Key<span class="token punctuation">.</span>mod4<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">Having</span><span class="token punctuation">(</span>a <span class="token operator">=&gt;</span> a<span class="token punctuation">.</span><span class="token function">Count</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">300</span> <span class="token operator">||</span> a<span class="token punctuation">.</span><span class="token function">Avg</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>Key<span class="token punctuation">.</span>mod4<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">OrderBy</span><span class="token punctuation">(</span>a <span class="token operator">=&gt;</span> a<span class="token punctuation">.</span>Key<span class="token punctuation">.</span>tt2<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">OrderByDescending</span><span class="token punctuation">(</span>a <span class="token operator">=&gt;</span> a<span class="token punctuation">.</span><span class="token function">Count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">ToList</span><span class="token punctuation">(</span>a <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token punctuation">{</span> a<span class="token punctuation">.</span>Key<span class="token punctuation">,</span> cou1 <span class="token operator">=</span> a<span class="token punctuation">.</span><span class="token function">Count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> arg1 <span class="token operator">=</span> a<span class="token punctuation">.</span><span class="token function">Avg</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>Value<span class="token punctuation">.</span>Clicks<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//SELECT substr(a.\`Title\`, 1, 2) as1, count(1) as2, avg(a.\`Id\`) as3</span>
<span class="token comment">//FROM \`Topic\` a</span>
<span class="token comment">//GROUP BY substr(a.\`Title\`, 1, 2), (a.\`Id\` % 4)</span>
<span class="token comment">//HAVING (count(1) &gt; 0 AND avg((a.\`Id\` % 4)) &gt; 0 AND max((a.\`Id\` % 4)) &gt; 0) AND (count(1) &lt; 300 OR avg((a.\`Id\` % 4)) &lt; 100)</span>
<span class="token comment">//ORDER BY substr(a.\`Title\`, 1, 2), count(1) DESC</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><blockquote><p>\u4E0D\u5206\u7EC4\u6C42\u805A\u5408\u503C\uFF0C\u8BF7\u4F7F\u7528 ToAggregate \u66FF\u4EE3 ToList</p></blockquote><h2 id="api" tabindex="-1"><a class="header-anchor" href="#api" aria-hidden="true">#</a> API</h2><table><thead><tr><th>\u65B9\u6CD5</th><th>\u8FD4\u56DE\u503C</th><th>\u53C2\u6570</th><th>\u63CF\u8FF0</th></tr></thead><tbody><tr><td>ToSql</td><td>string</td><td></td><td>\u8FD4\u56DE\u5373\u5C06\u6267\u884C\u7684 SQL \u8BED\u53E5</td></tr><tr><td>ToList&lt;T&gt;</td><td>List&lt;T&gt;</td><td>Lambda</td><td>\u6267\u884C SQL \u67E5\u8BE2\uFF0C\u8FD4\u56DE\u6307\u5B9A\u5B57\u6BB5\u7684\u8BB0\u5F55\uFF0C\u8BB0\u5F55\u4E0D\u5B58\u5728\u65F6\u8FD4\u56DE Count \u4E3A 0 \u7684\u5217\u8868</td></tr><tr><td>ToList&lt;T&gt;</td><td>List&lt;T&gt;</td><td>string field</td><td>\u6267\u884C SQL \u67E5\u8BE2\uFF0C\u8FD4\u56DE field \u6307\u5B9A\u5B57\u6BB5\u7684\u8BB0\u5F55\uFF0C\u5E76\u4EE5\u5143\u7EC4\u6216\u57FA\u7840\u7C7B\u578B(int,string,long)\u63A5\u6536\uFF0C\u8BB0\u5F55\u4E0D\u5B58\u5728\u65F6\u8FD4\u56DE Count \u4E3A 0 \u7684\u5217\u8868</td></tr><tr><td>ToAggregate&lt;T&gt;</td><td>List&lt;T&gt;</td><td>Lambda</td><td>\u6267\u884C SQL \u67E5\u8BE2\uFF0C\u8FD4\u56DE\u6307\u5B9A\u5B57\u6BB5\u7684\u805A\u5408\u7ED3\u679C\uFF08\u9002\u5408\u4E0D\u9700\u8981 GroupBy \u7684\u573A\u666F\uFF09</td></tr><tr><td>Sum</td><td>T</td><td>Lambda</td><td>\u6307\u5B9A\u4E00\u4E2A\u5217\u6C42\u548C</td></tr><tr><td>Min</td><td>T</td><td>Lambda</td><td>\u6307\u5B9A\u4E00\u4E2A\u5217\u6C42\u6700\u5C0F\u503C</td></tr><tr><td>Max</td><td>T</td><td>Lambda</td><td>\u6307\u5B9A\u4E00\u4E2A\u5217\u6C42\u6700\u5927\u503C</td></tr><tr><td>Avg</td><td>T</td><td>Lambda</td><td>\u6307\u5B9A\u4E00\u4E2A\u5217\u6C42\u5E73\u5747\u503C</td></tr><tr><td>\u3010\u5206\u7EC4\u3011</td><td></td><td></td><td></td></tr><tr><td>GroupBy</td><td>&lt;this&gt;</td><td>Lambda</td><td>\u6309\u9009\u62E9\u7684\u5217\u5206\u7EC4\uFF0CGroupBy(a =&gt; a.Name)</td></tr><tr><td>GroupBy</td><td>&lt;this&gt;</td><td>string, parms</td><td>\u6309\u539F\u751F sql \u8BED\u6CD5\u5206\u7EC4\uFF0CGroupBy(&quot;concat(name, ?cc)&quot;, new { cc = 1 })</td></tr><tr><td>Having</td><td>&lt;this&gt;</td><td>string, parms</td><td>\u6309\u539F\u751F sql \u8BED\u6CD5\u805A\u5408\u6761\u4EF6\u8FC7\u6EE4\uFF0CHaving(&quot;count(name) = ?cc&quot;, new { cc = 1 })</td></tr><tr><td>\u3010\u6210\u5458\u3011</td><td></td><td></td><td></td></tr><tr><td>Key</td><td></td><td></td><td>\u8FD4\u56DE GroupBy \u9009\u62E9\u7684\u5BF9\u8C61</td></tr><tr><td>Value</td><td></td><td></td><td>\u8FD4\u56DE\u4E3B\u8868 \u6216 From&lt;T2,T3....&gt; \u7684\u5B57\u6BB5\u9009\u62E9\u5668</td></tr></tbody></table>`,7);function p(o,e){return t}var l=n(a,[["render",p],["__file","select-group-by.html.vue"]]);export{l as default};
